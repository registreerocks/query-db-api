openapi: 3.0.0
info:
  description: ''
  version: 1.2.0
  title: Query DB
tags:
  - name: Query DB
    description: ''
paths:
  /query/degree:
    post:
      tags:
        - query
      summary: make and store a new query
      description: ''
      operationId: swagger_server.controllers.query_db_functions.query_degree
      responses:
        '200':
          description: OK
        '401':
          description: Authentication error
        '500':
          description: Internal error
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryDegree'
        description: query object
        required: true
  /dry_run/degree:
    post:
      tags:
        - query
      summary: get number of students in query
      description: ''
      operationId: swagger_server.controllers.query_db_functions.dry_run_degree
      responses:
        '200':
          description: OK
        '401':
          description: Authentication error
        '500':
          description: Internal error
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryDegree'
        description: query object
        required: true
  /expand/degree{id}:
    post:
      tags:
        - query
      summary: expand a query
      description: ''
      operationId: swagger_server.controllers.query_db_functions.expand_query_degree
      responses:
        '200':
          description: OK
        '401':
          description: Authentication error
        '500':
          description: Internal error
      parameters:
        - name: id
          in: path
          description: ID of query to be expanded
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryExpandDegree'
        description: query object
        required: true
  /query/get:
    get:
      tags:
        - query
      summary: retrieve query
      description: ''
      operationId: swagger_server.controllers.query_db_functions.get_query
      parameters:
        - in: query
          name: id
          description: query id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
        '400':
          description: Invalid input
        '401':
          description: Authentication error
        '409':
          description: Conflict
  /query/get_by_customer:
    get:
      tags:
        - query
      summary: retrieve queries by customer
      description: ''
      operationId: swagger_server.controllers.query_db_functions.get_queries_by_customer
      parameters:
        - in: query
          name: customer_id
          description: customer id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
        '401':
          description: Authentication error
        '409':
          description: Conflict
  /query/get_by_student:
    get:
      tags:
        - query
      summary: retrieve queries by student
      description: ''
      operationId: swagger_server.controllers.query_db_functions.get_queries_by_student
      parameters:
        - in: query
          name: student_address
          description: student address on blockchain
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
        '401':
          description: Authentication error
        '409':
          description: Conflict
  /query/get_rsvp:
    get:
      tags:
        - query
      summary: retrieve number of rsvp's of a query
      description: ''
      operationId: swagger_server.controllers.query_db_functions.get_rsvp
      parameters:
        - in: query
          name: id
          description: query id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
        '400':
          description: Invalid input
        '401':
          description: Authentication error
        '409':
          description: Conflict
  /query/update_status/{id}:
    post:
      tags:
        - query
      summary: update response status by student
      description: ''
      operationId: swagger_server.controllers.query_db_functions.update_status
      responses:
        '200':
          description: OK
        '401':
          description: Authentication error
        '409':
          description: Conflict
      parameters:
        - name: id
          in: path
          description: ID of event to be updated
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateStatus'
        description: student status update
        required: true
  /query/update/{id}:
    post:
      tags:
        - query
      summary: update event details
      description: ''
      operationId: swagger_server.controllers.query_db_functions.update
      responses:
        '200':
          description: OK
        '401':
          description: Authentication error
        '409':
          description: Conflict
      parameters:
        - name: id
          in: path
          description: ID of event to be updated
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Update'
        description: update parameters
        required: true
  /query/add_student_attendance/{id}:
    post:
      tags:
        - query
      summary: add student information on event attendance
      description: ''
      operationId: swagger_server.controllers.query_db_functions.add_student_attendance
      responses:
        '200':
          description: OK
        '401':
          description: Authentication error
        '409':
          description: Conflict
      parameters:
        - name: id
          in: path
          description: ID of event to be updated
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddInfo'
        description: student address, first name, last name, id
        required: true
  /query/notify_students/{id}:
    post:
      tags:
        - query
      summary: set students' notification status to "sent", return student ids
      description: ''
      operationId: swagger_server.controllers.query_db_functions.notify_students
      responses:
        '200':
          description: OK
        '401':
          description: Authentication error
        '409':
          description: Conflict
      parameters:
        - name: id
          in: path
          description: ID of event to which students should be invited
          required: true
          schema:
            type: string
servers:
  - url: 'http://localhost:8000/v0.1'
components:
  schemas:
    QueryDegree:
      type: object
      properties:
        customer_id:
          type: string
        event:
          type: object
          properties:
            type:
              type: string
            name:
              type: string
            address:
              type: string
            start_date:
              type: string
            end_date:
              type: string
            info:
              type: string
            flyer:
              type: string
            message:
              type: string
        query:
          type: object
          properties:
            details:
              type: array
              items:
                type: object
                properties:
                  university_id: 
                    type: string
                  university_name: 
                    type: string
                  faculty_id: 
                    type: string
                  faculty_name: 
                    type: string
                  degree_id:
                    type: string
                  degree_name:
                    type: string
                  absolute:
                    type: integer
                  percentage:
                    type: integer
      xml:
        name: QueryDegree
    QueryExpandDegree:
      type: array
      items:
        type: object
        properties:
          university_id: 
            type: string
          university_name: 
            type: string
          faculty_id: 
            type: string
          faculty_name: 
            type: string
          degree_id:
            type: string
          degree_name:
            type: string
          absolute:
            type: integer
          percentage:
            type: integer
      xml:
        name: QueryExpandDegree
    UpdateStatus:
      type: object
      properties:
        student_address:
          type: string
        viewed:
          type: boolean
        accepted:
          type: boolean
        attended:
          type: boolean
      xml:
        name: UpdateStatus
    Update:
      type: object
      properties:
        type:
          type: string
        name:
          type: string
        address:
          type: string
        start_date:
          type: string
        end_date:
          type: string
        info:
          type: string
        flyer:
          type: string
        message:
          type: string
      xml:
        name: Update
    AddInfo:
      type: object
      properties:
        student_address:
          type: string
        fist_name:
          type: string
        last_name:
          type: string
        student_id:
          type: string
      xml:
        name: AddInfo